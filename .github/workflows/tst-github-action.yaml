name: Test manual action run
on:
  workflow_dispatch:
    inputs:
      environment:
        description: "Environment under test"
        required: true
        default: "prod"
        type: choice
        options: ["prod"]

jobs:
  matrix-prep:
    name: Print the input
    runs-on: ubuntu-latest
    steps:
      - name: Fetch env specific params
        id: matrix-val
        run: |
          matrix_val=$(echo "${{ secrets.TEST_SECRET_1 }}" | jq '."${{ inputs.environment }}"')
          echo ::set-output name=matrix::{\"include\": $(echo $matrix_val)}
      - name: Print env specific params
        run: |
          echo ${{ steps.matrix-val.outputs.matrix}}
