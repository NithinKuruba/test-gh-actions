name: print out env vars

on: push

env:
  first_name: first_name
  last_name: last_name
  FIRST_NAME_LAST_NAME: nithinkuruba
  REF: test_secret
  name: TEST_SECRET
  GH_TOKEN: ${{ github.token }}

jobs:
  test-decoding-base64:
    runs-on: ubuntu-latest
    steps:
      - name: Fetch Action Logs
        id: summary
        run: |
          summary=$(gh run view 4008161095 --log --repo bcgov/sso-terraform | awk 'match($0, /Error: .*/) {print substr($0, RSTART, RLENGTH)}' | tr '\n' ',' | sed 's/\"//g' | sed -r 's/\x1B\[([0-9]{1,3}(;[0-9]{1,2};?)?)?[mGK]//g')
          echo "$summary"
          echo "summary=$summary" >> $GITHUB_OUTPUT
      - name: Rocket.Chat Notification
        uses: fjogeleit/http-request-action@master
        with:
          url: ${{ secrets.WEBHOOK }}
          method: "POST"
          customHeaders: '{"Content-Type": "application/json"}'
          data: '{"text": "${{ steps.summary.outputs.summary }}"}'
