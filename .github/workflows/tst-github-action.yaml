name: Build and Deploy

on:
  push:
    branches:
      - dev

jobs:
  build-and-deploy:
    runs-on: ubuntu-20.04
    env:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    steps:
      - name: Checkout Terraform Modules
        uses: actions/checkout@v3
        with:
          repository: bcgov/sso-terraform-modules
          ref: dev
      - name: Get Terraform Modules SHA
        run: |
          ls -lrta
          pwd
          git rev-parse --short HEAD
          echo "TF_MODULES_SHA=$(git rev-parse --short HEAD)" >> $GITHUB_OUTPUT
      - name: Checkout 🛎️
        uses: actions/checkout@v3

      - name: Commands
        run: |
          echo $TF_MODULES_SHA
          ls -lrta
          pwd
